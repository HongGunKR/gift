graph TD
    %% ì‚¬ìš©ì ì˜ì—­
    subgraph "ì‚¬ìš©ì ì˜ì—­"
        A["ğŸ‘¤ ì›¹ ì‚¬ìš©ì<br/>(Streamlit UI)"]
        A2["ğŸ§‘â€ğŸ’» API ì†Œë¹„ì<br/>(Swagger / HTTP Client)"]
    end

    %% ë°°í¬ ë° í™˜ê²½ ê´€ë¦¬
    subgraph "ë°°í¬ ë° í™˜ê²½ ê´€ë¦¬ (Docker Compose)"
        C(("Docker Compose"))
        D["ğŸ“œ docker-compose.yml"]
        E["ğŸ“œ Dockerfile"]
        F["ğŸ“ .env (OPENAI_API_KEY ë“±)"]
        B[("Docker Hub<br/>Python Base Image")]
    end

    %% Streamlit ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ
    subgraph "ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ (Streamlit App)"
        G["ğŸš€ Streamlit Server<br/>(í¬íŠ¸ 8501)"]
        G1("ë©”ì¸.py<br/>ì‹œì¥ ëŒ€ì‹œë³´ë“œ")
        G2("pages/1_TOP_100.py<br/>ì‹œì´ Top 100")
        G3("pages/2_ê²€ìƒ‰.py<br/>ê²€ìƒ‰ & LangGraph ë¶„ì„")
        G4("pages/3_AI_ì‹¬ì¸µë¶„ì„.py<br/>RAG ë¬¸ì„œ ë¶„ì„")
    end

    %% FastAPI ê³„ì¸µ
    subgraph "API ê³„ì¸µ (FastAPI)"
        P["ğŸ›°ï¸ Uvicorn Server<br/>(í¬íŠ¸ 8502)"]
        Q["ğŸ“œ app/web/api.py<br/>REST + Swagger UI"]
    end

    %% AI / ë°ì´í„° ë¡œì§
    subgraph "AI ë©€í‹° ì—ì´ì „íŠ¸ & ë°ì´í„° ë¡œì§"
        H["ğŸ¤– app/agents/langgraph.py<br/>(LangGraph Workflow)"]
        H2["ğŸ¤ app/agents/multi_agent.py<br/>(í€ë”ë©˜í„¸Â·ë‰´ìŠ¤Â·ë¦¬ìŠ¤í¬ í˜‘ì—…)"]
        I["ğŸ“œ app/services/data_fetcher.py<br/>(ì‹œì¥Â·ë‰´ìŠ¤Â·ê¸€ë¡œë²Œ ë°ì´í„°)"]
        R["ğŸ“Š analytics/technical.py<br/>(ê¸°ìˆ ì  ì§€í‘œ ê³„ì‚°)"]
    end

    %% ì™¸ë¶€ ë°ì´í„° ì†ŒìŠ¤ & ì €ì¥ì†Œ
    subgraph "ì™¸ë¶€ ë°ì´í„° ì†ŒìŠ¤ ë° ì €ì¥ì†Œ"
        J[("pykrx API<br/>êµ­ë‚´ ì£¼ì‹ ë°ì´í„°")]
        K[("DuckDuckGo Search API<br/>ë‰´ìŠ¤ ê²€ìƒ‰")]
        L[("OpenAI API<br/>LLM ì„œë¹„ìŠ¤")]
        Y[("Yahoo Finance Quotes<br/>ê¸€ë¡œë²Œ ì„ ë¬¼/í™˜ìœ¨")]
        M["/ğŸ“‚ reports/<br/>(PDF ì €ì¥ì†Œ)"]
    end

    %% ë‹¤ì´ì–´ê·¸ë¨ ë° ê°œë°œ ìœ í‹¸ë¦¬í‹°
    subgraph "ë‹¤ì´ì–´ê·¸ë¨ & ê°œë°œ ìœ í‹¸ë¦¬í‹°"
        N["ğŸ“œ diagram/visualize_graph.py<br/>LangGraph ì‹œê°í™” CLI"]
        O["ğŸ–¼ï¸ diagram/langgraph_flowchart.(png|svg)"]
    end

    %% ì‚¬ìš©ì â†’ ì• í”Œë¦¬ì¼€ì´ì…˜ íë¦„
    A -- "HTTP ìš”ì²­" --> G
    A2 -- "REST í˜¸ì¶œ / Swagger" --> P
    P --> Q

    %% Docker Compose ë¹Œë“œ/ì‹¤í–‰
    A -- "'docker-compose up --build' ì‹¤í–‰" --> C
    C -- "êµ¬ì„± ì°¸ì¡°" --> D
    C -- "ë¹Œë“œ ì»¨í…ìŠ¤íŠ¸" --> E
    E -- "ë² ì´ìŠ¤ ì´ë¯¸ì§€" --> B
    E -- "ì‹œìŠ¤í…œ ì˜ì¡´ì„± (Graphviz ë“±) ì„¤ì¹˜" --> B
    E -- "Python íŒ¨í‚¤ì§€ ì„¤ì¹˜" --> C
    C -- "í™˜ê²½ ë³€ìˆ˜ ì£¼ì…" --> F
    C -- "ë³´ê³ ì„œ ë³¼ë¥¨ ë§ˆìš´íŠ¸" --> M
    C -- "Streamlit ì»¨í…Œì´ë„ˆ ê¸°ë™" --> G
    C -- "Uvicorn ì»¨í…Œì´ë„ˆ ê¸°ë™" --> P
    C -- "í¬íŠ¸ ë…¸ì¶œ (8501, 8502)" --> A
    C -- "í¬íŠ¸ ë…¸ì¶œ (Swagger)" --> A2

    %% Streamlit í˜ì´ì§€ í˜¸ì¶œ
    G -- "í˜ì´ì§€ ì„ íƒ" --> G1
    G -- "í˜ì´ì§€ ì„ íƒ" --> G2
    G -- "í˜ì´ì§€ ì„ íƒ" --> G3
    G -- "í˜ì´ì§€ ì„ íƒ" --> G4

    %% ë°ì´í„° ë¡œì§ ì—°ê²°
    G1 -- "ì§€ìˆ˜/ì„¹í„°/ê¸€ë¡œë²Œ ë°ì´í„° ìš”ì²­" --> I
    G2 -- "ì‹œì´ Top100 ìš”ì²­" --> I
    G3 -- "ì¢…ëª©Â·ê¸°ìˆ  ì§€í‘œ ìš”ì²­" --> I
    G3 -- "ì´ë™í‰ê·  ê³„ì‚°" --> R
    G4 -- "PDF ë¶„ì„ ìš”ì²­" --> H

    %% LangGraph ì—ì´ì „íŠ¸ íë¦„
    G3 -- "LangGraph ë¶„ì„" --> H
    H -- "ë°ì´í„° ì¡°íšŒ" --> I
    H -- "PDF ë¡œë“œ" --> M
    H -- "LLM í˜¸ì¶œ" --> L

    %% ë©€í‹° ì—ì´ì „íŠ¸ API íë¦„
    Q -- "REST Endpoints" --> H2
    H2 -- "ì‹œì¥ ë°ì´í„°/ë‰´ìŠ¤ ìš”ì²­" --> I
    H2 -- "LLM í˜¸ì¶œ" --> L
    H2 -- "ë‰´ìŠ¤ ìš”ì•½" --> K
    H2 -- "ê¸°ì´ˆ ë°ì´í„°" --> J

    %% ì™¸ë¶€ ë°ì´í„° í˜¸ì¶œ
    I -- "ì‹œì¥ ë°ì´í„°" --> J
    I -- "ë‰´ìŠ¤ ê²€ìƒ‰" --> K
    I -- "ê¸€ë¡œë²Œ ì‹œì„¸" --> Y

    %% ë‹¤ì´ì–´ê·¸ë¨ CLI íë¦„
    A -- "'python3 diagram/visualize_graph.py --format png --output diagram/langgraph.png' ì‹¤í–‰" --> N
    N -- "app/agents/langgraph.py ê·¸ë˜í”„ ë¡œë”©" --> H
    N -- "Mermaid ë Œë”ë§ (Pyppeteer)" --> O
